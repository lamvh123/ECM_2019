<section class="content" [ngStyle]="{'margin': '15px 15px 15px 15px','padding': '15px 15px 15px 15px'}">
  <ng-http-loader
    [backgroundColor]="'#ff0000'"
    [debounceDelay]="1000"
    [extraDuration]="3003"
    [minDuration]="3003"
  >
  </ng-http-loader>

  <div class="row clearfix">
    <div class="col-lg-12 col-md-12 col-sm-12">
      <div class="card">
        <div style="float: left;width: 48%;margin-left: 1%">
          <ng-select [items]="listCourse" bindLabel="Name" bindValue="Id" placeholder="Select Course"
                     (change)="ReLoadForm()"
                     (clear)="ReLoadForm()" [(ngModel)]="selectedCourseId">
          </ng-select>
        </div>
        <div style="float: left;width: 47%;margin-left: 1%">
          <ng-select [items]="listForm" bindLabel="Name" bindValue="Id" [(ngModel)]="selectedFormId"
                     placeholder="Select Form">
          </ng-select>
        </div>
        <br style="clear: left;"/>
        <div style="float: left;width: 48%;margin-left: 1%">
          <div class="form-group">
            <div class="form-line">
              <input type="text" [(ngModel)]="studentName" class="form-control" placeholder="Student Name">
            </div>
          </div>
        </div>
        <div style="float: left;width: 47%;margin-left: 1%">
          <div class="form-group">
            <div class="form-line">
              <input type="text" [(ngModel)]="phoneNumber" class="form-control" placeholder="Phone Number" required
                     (keypress)="isInputNumber($event)">
            </div>
          </div>
        </div>
        <br style="clear: left;"/>
        <button style="float: right;margin-right: 1%" type="submit" name="_submit" (click)="searchStudent()"
                class="btn g-bg-gy searchBtn">
          Search Student
        </button>
      </div>
    </div>
  </div>

  <div [ngStyle]="isLoading?{'display':'none'}:{}">
    <div class="row clearfix all-program-content">
      <div class="col-lg-12 col-md-12 col-sm-12">
        <div class="card">
          <div *ngIf="empty" class="header">
            <h3>There is no student in database.</h3>
            <!--            <ul class="header-dropdown">-->
            <!--              <li class="dropdown"><a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown"-->
            <!--                                      role="button" aria-haspopup="true" aria-expanded="false"> <i-->
            <!--                class="zmdi zmdi-more-vert"></i> </a>-->
            <!--                <ul class="dropdown-menu pull-right">-->
            <!--                  <li><a href="javascript:void(0);">Action</a></li>-->
            <!--                  <li><a href="javascript:void(0);">Another action</a></li>-->
            <!--                  <li><a href="javascript:void(0);">Something else here</a></li>-->
            <!--                </ul>-->
            <!--              </li>-->
            <!--            </ul>-->
          </div>

          <div *ngIf="!empty" class="body">
            <ul class="pagination justify-content-center">
              <li class="page-item disabled" *ngIf="currentPage==1">
                <a class="page-link" href="javascript:;">First</a>
              </li>
              <li class="page-item" *ngIf="currentPage!=1">
                <a class="page-link" href="javascript:;" (click)="changePage(1)">First</a>
              </li>
              <li *ngFor="let p of listPageDisplay" class="page-item" [class.active]="currentPage==p">
                <a class="page-link" href="javascript:;" (click)="changePage(p)">{{p}}</a>
              </li>
              <li class="page-item disabled" *ngIf="currentPage==listPage.length">
                <a class="page-link" href="javascript:;">Last</a>
              </li>
              <li class="page-item" *ngIf="currentPage!=listPage.length">
                <a class="page-link" href="javascript:;" (click)="changePage(listPage.length)">Last</a>
              </li>
            </ul>
          </div>

          <div *ngIf="!empty" class="body table-responsive">
            <table class="table table-bordered table-striped table-hover js-basic-example dataTable">
              <thead>
              <tr>

                <th scope="col" style="vertical-align: bottom">

                  <div class="btn-group" style="box-shadow: none">
                    <input type="checkbox" name="selectAll" id="selectAll"
                           class="filled-in chk-col-pink" [checked]="isSelectedAll"
                           (change)="selectAllFun()"/>
                    <label for="selectAll"></label>
                    <!--                    <button type="button" class="btn btn-primary">Split me</button>-->
                    <div [ngStyle]="isSelectedAll?{}:{'visibility': 'hidden'}" class="btn-group" ngbDropdown
                         role="group"
                         aria-label="Button group with nested dropdown">
                      <span ngbDropdownToggle></span>
                      <ul class="dropdown-menu" ngbDropdownMenu>
                        <li ngbDropdownItem style="font-weight:normal" (click)="ConfirmMultiple()"><a
                          href="javascript:;">Confirm selected</a></li>
                        <li ngbDropdownItem style="font-weight:normal" (click)="RejectMultiple()"><a
                          href="javascript:;">Reject selected</a></li>
                      </ul>
                    </div>
                  </div>

                </th>


                <th scope="col">Student Name</th>
                <th scope="col">Student Email</th>
                <th scope="col">Date of birth</th>
                <th scope="col">Student's Phone</th>
                <th scope="col">Gender</th>
                <th scope="col">Parent's Name</th>
                <th scope="col">Parent's Phone</th>
                <th scope="col">Parent's Gmail</th>
                <th scope="col">Payment's Status</th>
                <th scope="col">Action</th>

              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let student of listStudent;let index = index;">
                <th scope="row" style="vertical-align: bottom">
                  <div class="checkbox">
                    <input type="checkbox" name="rememberme{{index}}" id="rememberme{{index}}"
                           class="filled-in chk-col-pink" [checked]="student.selected"
                           (change)="updateSelectAllStatus(student)"/>
                    <label for="rememberme{{index}}"></label>
                  </div>
                </th>
                <td>{{student.Name}}</td>
                <td>{{student.Email}}</td>
                <td>{{student.Dob}}</td>
                <td>{{student.Phone}}</td>
                <td>{{student.realSex}}</td>
                <td>{{student.Parent_Name}}</td>
                <td>{{student.Parent_Phone}}</td>
                <td>{{student.Parent_Gmail}}</td>
                <td [class.check-availble]="student.IsPayment"
                    [class.reject-availble]="!student.IsPayment">{{student.IsPayment ? 'Paid' : 'Not Yet'}}</td>
                <td>
                  <div class="row">
                    <ng-container *ngIf="!student.IsPayment; then canCheck; else cannotCheck"></ng-container>

                    <ng-template #canCheck>
                      <div class="col-lg-5 col-xl-5">
                        <button (click)="ConfirmFee(student,index)" class="confirm-btn">
                          <i class="fa fa-check check-availble" style="font-size:24px" aria-hidden="true"></i>
                        </button>
                      </div>
                      <div class="col-lg-5 col-xl-5">
                        <button class="confirm-btn">
                          <i class="fa fa-times reject-unavailble" style="font-size:24px"></i>
                        </button>
                      </div>
                    </ng-template>
                    <ng-template #cannotCheck>
                      <div class="col-lg-5 col-xl-5">
                        <button class="confirm-btn">
                          <i class="fa fa-check check-unavailble" style="font-size:24px" aria-hidden="true"></i>
                        </button>
                      </div>

                      <div class="col-lg-5 col-xl-5">
                        <button (click)="RejectFee(student,index)" class="confirm-btn">
                          <i class="fa fa-times reject-availble" style="font-size:24px"></i>
                        </button>
                      </div>
                    </ng-template>
                  </div>
                </td>
              </tr>
              </tbody>
            </table>
          </div>

          <div *ngIf="!empty" class="body">
            <ul class="pagination justify-content-center">
              <li class="page-item disabled" *ngIf="currentPage==1">
                <a class="page-link" href="javascript:;">First</a>
              </li>
              <li class="page-item" *ngIf="currentPage!=1">
                <a class="page-link" href="javascript:;" (click)="changePage(1)">First</a>
              </li>
              <li *ngFor="let p of listPageDisplay" class="page-item" [class.active]="currentPage==p">
                <a class="page-link" href="javascript:;" (click)="changePage(p)">{{p}}</a>
              </li>
              <li class="page-item disabled" *ngIf="currentPage==listPage.length">
                <a class="page-link" href="javascript:;">Last</a>
              </li>
              <li class="page-item" *ngIf="currentPage!=listPage.length">
                <a class="page-link" href="javascript:;" (click)="changePage(listPage.length)">Last</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <app-loading-page *ngIf="isLoading"></app-loading-page>

</section>
